<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml" xmlns:v-on="http://www.w3.org/1999/xhtml">
<head th:fragment="head(title)">
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link th:href="@{/css/bootstrap.min.css}" href="/mycloudmongo/static/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"/>
    <link th:href="@{/css/bootstrap-theme.min.css}" href="/mycloudmongo/static/css/bootstrap-theme.min.css"
          rel="stylesheet"
          integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous"/>
    <link th:href="@{/image/favicon.ico}" href="/mycloudmongo/static/image/favicon.ico" rel="shortcut icon"
          type="image/ico"/>
    <title th:text="${title}">global</title>
</head>
<body>
<div class="container">

    <div class="row" th:fragment="navigation">
        <nav class="navbar navbar-default" role="navigation">
            <div class="container-fluid">
                <div class="navbar-header">
                    <img th:src="@{/image/favicon.ico}" src="/mycloudmongo/static/image/favicon.ico"
                         class="navbar-brand"/>
                </div>
                <ul class="nav navbar-nav">
                    <li><a th:href="@{/file}" class="navbar-brand">文件列表</a></li>
                    <li><a th:href="@{/log}" class="navbar-brand">日志列表</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <button th:onclick="'javascript:restoreAll();'"
                                class="btn btn-info navbar-btn">全部<b>恢复</b></button>
                    </li>
                    <li>
                        <button th:onclick="'javascript:backupAll();'"
                                class="btn btn-warning navbar-btn">全部<b>备份</b></button>
                    </li>
                    <li><p class="navbar-text">我的文件床 mycloud</p></li>
                </ul>
            </div>
        </nav>
        <br/>
    </div>


    <div class="row" th:fragment="addFileForm">
        <div class="page-header">
            <h3>上传文件</h3>
        </div>
        <form th:action="@{/api/addFile}" method="post" id="addFileForm" class="form-horizontal" role="form"
              enctype="multipart/form-data" onsubmit="return false;">
            <div class="form-group">
                <label class="col-sm-2 control-label">上传文件</label>
                <div class="col-sm-10">
                    <input type="file" name="file" id="addFileFormFile" class="form-control" required="required"/>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">上传日期</label>
                <div class="col-sm-10">
                    <input th:value="${#dates.format(new java.util.Date(),'yyyy-MM-dd')}" type="date" name="pathDate"
                           id="addFileFormPathDate" class="form-control"/>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">描述</label>
                <div class="col-sm-10">
                    <textarea name="description" id="addFileFormDescription" class="form-control"></textarea>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-10"></div>
                <div class="col-sm-2">
                    <button type="submit" class="btn btn-default" onclick="uploadFile()">上传</button>
                </div>
            </div>
        </form>
    </div>


    <div class="row" th:fragment="addHttpUrlForm">
        <div class="page-header">
            <h3>上传链接</h3>
        </div>
        <form th:action="@{/api/addHttpUrl}" method="post" id="addHttpUrlForm" class="form-horizontal" role="form"
              onsubmit="return false;">
            <div class="form-group">
                <label class="col-sm-2 control-label">链接</label>
                <div class="col-sm-10">
                    <input type="text" name="httpUrl" id="addHttpUrlFormUrl" class="form-control" required="required"/>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">上传日期</label>
                <div class="col-sm-10">
                    <input th:value="${#dates.format(new java.util.Date(),'yyyy-MM-dd')}" type="date" name="pathDate"
                           id="addHttpUrlFormPathDate" class="form-control"/>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">描述</label>
                <div class="col-sm-10">
                    <textarea name="description" id="addHttpUrlFormDescription" class="form-control"></textarea>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-10"></div>
                <div class="col-sm-2">
                    <button type="submit" class="btn btn-default" onclick="uploadHttpUrl()">上传</button>
                </div>
            </div>
        </form>
    </div>


    <div class="row" th:fragment="listFile">
        <table class="table table-hover" id="listFile">
            <caption>文件列表</caption>
            <thead>
            <tr>
                <th>缩略图</th>
                <th>信息</th>
            </tr>
            </thead>
            <tbody>
            <tr v-for="file in files">
                <td><a :href="file.url" target="_blank"><img :alt="file.filename" :src="file.url" class="img-responsive"
                                                             style="max-height: 100%;max-width: 100%"/></a>
                </td>
                <td>
                    <table class="table table-hover" style="background-color: rgba(0, 0, 0, 0);">
                        <tbody>
                        <tr>
                            <td>文件名</td>
                            <td><code>{{ file.filename }}</code></td>
                        </tr>
                        <tr>
                            <td>路径日期</td>
                            <td><code>{{ new Date(file.pathDate).format("yyyy-MM-dd") }}</code></td>
                        </tr>
                        <tr>
                            <td>链接</td>
                            <td><code>{{ file.url }}</code></td>
                        </tr>
                        <tr>
                            <td>文件位置</td>
                            <td><code>{{ file.file }}</code></td>
                        </tr>
                        <tr>
                            <td>id</td>
                            <td><code>{{ file.id }}</code></td>
                        </tr>
                        <tr>
                            <td>文件类型</td>
                            <td><code>{{ file.contentType }}</code></td>
                        </tr>
                        <tr>
                            <td>上传日期</td>
                            <td><code>{{ new Date(file.uploadDate).format("yyyy-MM-dd hh:mm:ss") }}</code></td>
                        </tr>
                        <tr>
                            <td>文件大小</td>
                            <td><code>{{ file.length }} B</code></td>
                        </tr>
                        <tr>
                            <td>MD5</td>
                            <td><code>{{ file.md5 }}</code></td>
                        </tr>
                        <tr>
                            <td>操作</td>
                            <td>
                                <button v-on:click="restore(file.id,file.filename)" type="button" class="btn btn-info">
                                    恢复
                                </button>
                                <button v-on:click="backup(file.id,file.filename)" type="button"
                                        class="btn btn-warning">备份
                                </button>
                                <button v-on:click="remove(file.id,file.filename)" type="button" class="btn btn-danger">
                                    删除
                                </button>
                            </td>
                        </tr>
                        <tr>
                            <td>描述</td>
                            <td><code>{{ file.description }}</code></td>
                        </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
            </tbody>
        </table>
    </div>


    <div class="row" th:fragment="listLog">
        <table class="table table-hover" id="listLog">
            <caption>日志列表</caption>
            <tbody>
            <tr v-for="log in logs">
                <td>
                    <table class="table" style="background-color: rgba(0, 0, 0, 0);">
                        <tbody>
                        <tr>
                            <pre :style="log.success?'background-color: rgba(50, 205, 50, 0.7);':'background-color: rgba(255, 99, 71, 0.7);'"><code>{{ log.log }}</code></pre>
                        </tr>
                        <tr>
                            <td>任务日期</td>
                            <td><code>{{ new Date(log.date).format("yyyy-MM-dd hh:mm:ss") }}</code></td>
                        </tr>
                        <tr>
                            <td>目标</td>
                            <td>
                                <pre><code>{{ log.targetName }}</code></pre>
                            </td>
                        </tr>
                        <tr>
                            <td>路径日期</td>
                            <td><code>{{ new Date(log.pathDate).format("yyyy-MM-dd") }}</code></td>
                        </tr>
                        <tr>
                            <td>描述</td>
                            <td><code>{{ log.description }}</code></td>
                        </tr>
                        <tr>
                            <td>任务</td>
                            <td><code>{{ log.taskName }}</code></td>
                        </tr>
                        <tr>
                            <td>结果</td>
                            <td><code>{{ log.success }}</code></td>
                        </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
            </tbody>
        </table>
    </div>


    <div class="row" style="text-align: center" th:fragment="pagination">
        <ul id="pagination" class="pagination">
            <li v-for="page in pages" v-on:click="flipPage(page.url)" :class="page.current?'active':''"><a>{{ page.name
                }}</a></li>
        </ul>
    </div>


    <div class="row" th:fragment="loginForm">

        <div class="page-header">
            <h1>
                mycloud后台管理登录
                <small th:if="${param.error}">
                    账号或密码错误
                </small>
                <small th:if="${param.logout}">
                    你已经注销
                </small>
            </h1>
        </div>
        <form th:action="@{/login}" method="post" class="form-horizontal" role="form">
            <div class="form-group">
                <label class="col-sm-2 control-label">账号</label>
                <div class="col-sm-10">
                    <input type="text" name="username" class="form-control" required="required"/>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">密码</label>
                <div class="col-sm-10">
                    <input type="password" name="password" class="form-control" required="required"/>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-10"></div>
                <div class="col-sm-2">
                    <button type="submit" class="btn btn-default">上传</button>
                </div>
            </div>
        </form>
    </div>


    <div class="row" th:fragment="tail">
        <div style="text-align: center;padding: 2%;margin-top: 2%;background-color: rgba(255, 140, 0, 0.7);">
            <p>我的文件床 mycloud</p>
            <p>2018-04-10 mongodb版本</p>
        </div>
    </div>

</div>

<div th:fragment="publicJs">
    <script>
        Date.prototype.format = function (fmt) {
            var o = {
                "M+": this.getMonth() + 1, //月份
                "d+": this.getDate(), //日
                "h+": this.getHours(), //小时
                "m+": this.getMinutes(), //分
                "s+": this.getSeconds(), //秒
                "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                "S": this.getMilliseconds() //毫秒
            };
            if (/(y+)/.test(fmt)) {
                fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
            }
            for (var k in o) {
                if (new RegExp("(" + k + ")").test(fmt)) {
                    fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ?
                        (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
                }
            }
            return fmt;
        };
    </script>
    <script th:src="@{/js/jquery-3.2.1.min.js}" src="/mycloudmongo/static/js/jquery-3.2.1.min.js"
            type="text/javascript"></script>
    <script th:src="@{/js/bootstrap.min.js}" src="/mycloudmongo/static/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>
    <script th:src="@{/js/vue.js}" src="/mycloudmongo/static/js/vue.js"></script>
</div>
<div th:fragment="privateJs">
    <script th:src="@{/js/private.js}" src="/mycloudmongo/static/js/private.js"></script>
    <input th:value="@{/api/createFilePackagePages}" id="createFilePackagePages" type="hidden"/>
    <input th:value="@{/api/findFilePackages}" id="findFilePackages" type="hidden"/>
    <input th:value="@{/api/createTaskPages}" id="createTaskPages" type="hidden"/>
    <input th:value="@{/api/findTasks}" id="findTasks" type="hidden"/>
    <input th:value="@{/api/restoreFilePackageById}" id="restoreFilePackageById" type="hidden"/>
    <input th:value="@{/api/backupFilePackageById}" id="backupFilePackageById" type="hidden"/>
    <input th:value="@{/api/removeFilePackageById}" id="removeFilePackageById" type="hidden"/>
    <input th:value="@{/api/backupAllFilePackage}" id="backupAllFilePackage" type="hidden"/>
    <input th:value="@{/api/restoreAllFilePackage}" id="restoreAllFilePackage" type="hidden"/>
    <script>
        var createFilePackagePagesUrl = null;
        var findFilePackagesUrl = null;
        var createTaskPagesUrl = null;
        var findTasksUrl = null;
        var restoreFilePackageByIdUrl = null;
        var backupFilePackageByIdUrl = null;
        var removeFilePackageByIdUrl = null;
        var backupAllFilePackageUrl = null;
        var restoreAllFilePackageUrl = null;

        function createFilePackagePagesUrl() {
            if (createFilePackagePagesUrl == null || createFilePackagePagesUrl == '') {
                createFilePackagePagesUrl = $("#createFilePackagePages").attr("value");
            }
            return createFilePackagePagesUrl;
        }
        function findFilePackagesUrl() {
            if (findFilePackagesUrl == null || findFilePackagesUrl == '') {
                findFilePackagesUrl = $("#findFilePackages").attr("value");
            }
            return findFilePackagesUrl;
        }
        function createTaskPagesUrl() {
            if (createTaskPagesUrl == null || createTaskPagesUrl == '') {
                createTaskPagesUrl = $("#createTaskPages").attr("value");
            }
            return createTaskPagesUrl;
        }
        function findTasksUrl() {
            if (findTasksUrl == null || findTasksUrl == '') {
                findTasksUrl = $("#findTasks").attr("value");
            }
            return findTasksUrl;
        }
        function restoreFilePackageByIdUrl() {
            if (restoreFilePackageByIdUrl == null || restoreFilePackageByIdUrl == '') {
                restoreFilePackageByIdUrl = $("#restoreFilePackageById").attr("value");
            }
            return restoreFilePackageByIdUrl;
        }
        function backupFilePackageByIdUrl() {
            if (backupFilePackageByIdUrl == null || backupFilePackageByIdUrl == '') {
                backupFilePackageByIdUrl = $("#backupFilePackageById").attr("value");
            }
            return backupFilePackageByIdUrl;
        }
        function removeFilePackageByIdUrl() {
            if (removeFilePackageByIdUrl == null || removeFilePackageByIdUrl == '') {
                removeFilePackageByIdUrl = $("#removeFilePackageById").attr("value");
            }
            return removeFilePackageByIdUrl;
        }
        function backupAllFilePackageUrl() {
            if (backupAllFilePackageUrl == null || backupAllFilePackageUrl == '') {
                backupAllFilePackageUrl = $("#backupAllFilePackage").attr("value");
            }
            return backupAllFilePackageUrl;
        }
        function restoreAllFilePackageUrl() {
            if (restoreAllFilePackageUrl == null || restoreAllFilePackageUrl == '') {
                restoreAllFilePackageUrl = $("#restoreAllFilePackage").attr("value");
            }
            return restoreAllFilePackageUrl;
        }
    </script>
</div>
<script>
    var paginationVue = createPaginationVue();
    var pages = [
        {
            "name": "首页",
            "url": "1",
            "current": true
        },
        {
            "name": "1",
            "url": "1",
            "current": true
        },
        {
            "name": "2",
            "url": "2",
            "current": false
        },
        {
            "name": "3",
            "url": "3",
            "current": false
        },
        {
            "name": "尾页",
            "url": "3",
            "current": false
        }
    ];
    paginationVue.loadData({result: true, data: pages});

    var listLogVue = createListLogVue();
    var logs = [
        {
            "targetName": "/home/cellargalaxy/tmpFile/tmp/201709/09/Shelter the Animation [BDrip x265 10bit 1920x1080 FLAC].mkv_20180130_111627.715.jpg",
            "pathDate": 1504886400000,
            "description": null,
            "taskName": null,
            "log": "FilePackage{file=/home/cellargalaxy/tmpFile/tmp/201709/09/Shelter the Animation [BDrip x265 10bit 1920x1080 FLAC].mkv_20180130_111627.715.jpg, pathDate=Sat Sep 09 00:00:00 CST 2017, filename='Shelter the Animation [BDrip x265 10bit 1920x1080 FLAC].mkv_20180130_111627.715.jpg', description='null', id='5aca2f8c9e56fe24a801f513', uploadDate=Sun Apr 08 23:04:44 CST 2018, length=303486, contentType='null', md5='8a4d4a503c40ca85242fddc489dbb17d', url='http://drive.cellargalaxy.top/201709/09/Shelter the Animation [BDrip x265 10bit 1920x1080 FLAC].mkv_20180130_111627.715.jpg'}",
            "success": true,
            "date": 1523201065207
        },
        {
            "targetName": "/home/cellargalaxy/tmpFile/tmp/201709/09/Shelter the Animation [BDrip x265 10bit 1920x1080 FLAC].mkv_20180130_111936.987.jpg",
            "pathDate": 1504886400000,
            "description": null,
            "taskName": null,
            "log": "FilePackage{file=/home/cellargalaxy/tmpFile/tmp/201709/09/Shelter the Animation [BDrip x265 10bit 1920x1080 FLAC].mkv_20180130_111936.987.jpg, pathDate=Sat Sep 09 00:00:00 CST 2017, filename='Shelter the Animation [BDrip x265 10bit 1920x1080 FLAC].mkv_20180130_111936.987.jpg', description='null', id='5aca2f8c9e56fe24a801f517', uploadDate=Sun Apr 08 23:04:44 CST 2018, length=194772, contentType='null', md5='20571636c52f1cad39d82c0729d1e582', url='http://drive.cellargalaxy.top/201709/09/Shelter the Animation [BDrip x265 10bit 1920x1080 FLAC].mkv_20180130_111936.987.jpg'}",
            "success": false,
            "date": 1523201065207
        }
    ];
    listLogVue.loadData({result: true, data: logs});

    var listFileVue = createListFileVue();
    var files = [
        {
            "file": "/home/cellargalaxy/tmpFile/tmp/201709/09/Shelter the Animation [BDrip x265 10bit 1920x1080 FLAC].mkv_20180130_111941.907.jpg",
            "pathDate": 1504886400000,
            "filename": "Shelter the Animation [BDrip x265 10bit 1920x1080 FLAC].mkv_20180130_111941.907.jpg",
            "description": null,
            "id": "5aca2f8c9e56fe24a801f508",
            "uploadDate": 1523199884051,
            "length": 311057,
            "contentType": null,
            "md5": "c6fc17759a72c90a9c16cc62dd0bb8f1",
            "url": "http://drive.cellargalaxy.top/201709/09/Shelter the Animation [BDrip x265 10bit 1920x1080 FLAC].mkv_20180130_111941.907.jpg"
        },
        {
            "file": "/home/cellargalaxy/tmpFile/tmp/201709/09/Shelter the Animation [BDrip x265 10bit 1920x1080 FLAC].mkv_20180130_111752.334.jpg",
            "pathDate": 1504886400000,
            "filename": "Shelter the Animation [BDrip x265 10bit 1920x1080 FLAC].mkv_20180130_111752.334.jpg",
            "description": null,
            "id": "5aca2f8c9e56fe24a801f50c",
            "uploadDate": 1523199884068,
            "length": 293388,
            "contentType": null,
            "md5": "2b9b46fc176195a9d80ea0c205e2915e",
            "url": "http://drive.cellargalaxy.top/201709/09/Shelter the Animation [BDrip x265 10bit 1920x1080 FLAC].mkv_20180130_111752.334.jpg"
        }
    ];
    listFileVue.loadData({result: true, data: files});
</script>

</body>
</html>